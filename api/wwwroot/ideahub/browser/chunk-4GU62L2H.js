import{c as me,d as ge,e as fe}from"./chunk-LC37VKO2.js";import{a as re,b as S,c as ae,d as se,g as de,h as le,i as ce,j as pe,k as ue,l as R,m as F}from"./chunk-B4FG6HFE.js";import{a as ne}from"./chunk-263ANN6R.js";import"./chunk-4YNICMPY.js";import{d as ee,e as k,h as te,i as N,m as C,o as U,s as ie,u as oe}from"./chunk-P4JQYPRK.js";import{Bb as h,Cb as p,Fb as Y,Gb as K,Hb as Q,Ja as s,Kb as v,Mb as l,Nb as M,Oa as O,Ob as I,Pb as j,Qb as D,Tb as J,U as T,Ua as b,Vb as Z,Y as E,_a as V,a as G,b as q,c as w,ca as m,d as B,da as g,db as f,kb as $,ob as c,pb as r,q as x,qb as a,rb as P,vb as X,wb as W,xb as _}from"./chunk-EDNIDIBE.js";var Me=["descriptionTextarea"];function Se(n,t){n&1&&(r(0,"h2"),l(1,"Share Your Idea"),a())}function we(n,t){n&1&&(r(0,"h2"),l(1,"Edit Idea"),a())}function ye(n,t){n&1&&(r(0,"span",25),l(1,"\u26A0\uFE0F"),a())}function Ee(n,t){n&1&&(r(0,"span",25),l(1,"\u26D4"),a())}function Pe(n,t){if(n&1&&(r(0,"div",23),f(1,ye,2,0,"span",24)(2,Ee,2,0,"span",24),l(3),a()),n&2){let e=p();v("warning",e.isTitleWarning)("limit-reached",e.isTitleLimitReached)("error",e.isTitleError),s(),c("ngIf",e.isTitleLimitReached),s(),c("ngIf",e.isTitleError),s(),I(" ",e.titleLimitMessage," ")}}function Te(n,t){n&1&&(r(0,"span"),l(1,"Title is required"),a())}function Oe(n,t){n&1&&(r(0,"span"),l(1,"Title must be at least 3 characters"),a())}function Ve(n,t){if(n&1&&(r(0,"span"),l(1),a()),n&2){let e=p(2);s(),I("Title cannot exceed ",e.TITLE_MAX_LENGTH," characters")}}function De(n,t){if(n&1&&(r(0,"div",26),f(1,Te,2,0,"span",4)(2,Oe,2,0,"span",4)(3,Ve,2,1,"span",4),a()),n&2){let e,i,o,d=p();s(),c("ngIf",(e=d.ideaForm.get("title"))==null||e.errors==null?null:e.errors.required),s(),c("ngIf",(i=d.ideaForm.get("title"))==null||i.errors==null?null:i.errors.minlength),s(),c("ngIf",(o=d.ideaForm.get("title"))==null||o.errors==null?null:o.errors.maxlength)}}function ke(n,t){n&1&&P(0,"div",27)}function Ne(n,t){n&1&&(r(0,"span",25),l(1,"\u26A0\uFE0F"),a())}function Ue(n,t){n&1&&(r(0,"span",25),l(1,"\u26D4"),a())}function Re(n,t){if(n&1&&(r(0,"div",23),f(1,Ne,2,0,"span",24)(2,Ue,2,0,"span",24),l(3),a()),n&2){let e=p();v("warning",e.isDescriptionWarning)("limit-reached",e.isDescriptionLimitReached)("error",e.isDescriptionError),s(),c("ngIf",e.isDescriptionLimitReached),s(),c("ngIf",e.isDescriptionError),s(),I(" ",e.descriptionLimitMessage," ")}}function Fe(n,t){n&1&&(r(0,"span"),l(1,"Description is required"),a())}function Le(n,t){n&1&&(r(0,"span"),l(1,"Description must be at least 10 characters"),a())}function Ae(n,t){if(n&1&&(r(0,"span"),l(1),a()),n&2){let e=p(2);s(),I("Description cannot exceed ",e.DESCRIPTION_MAX_LENGTH," characters")}}function Ge(n,t){if(n&1&&(r(0,"div",26),f(1,Fe,2,0,"span",4)(2,Le,2,0,"span",4)(3,Ae,2,1,"span",4),a()),n&2){let e,i,o,d=p();s(),c("ngIf",(e=d.ideaForm.get("description"))==null||e.errors==null?null:e.errors.required),s(),c("ngIf",(i=d.ideaForm.get("description"))==null||i.errors==null?null:i.errors.minlength),s(),c("ngIf",(o=d.ideaForm.get("description"))==null||o.errors==null?null:o.errors.maxlength)}}function $e(n,t){if(n&1&&(r(0,"span"),l(1),a()),n&2){let e=p();s(),I(" ",e.isEditMode?"Saving...":"Sharing..."," ")}}function je(n,t){if(n&1&&(r(0,"span"),l(1),a()),n&2){let e=p();s(),I(" ",e.isEditMode?"Save Changes":"Share Idea"," ")}}var L=class n{constructor(t){this.fb=t;this.ideaForm=this.fb.group({title:["",[S.required,S.minLength(3),S.maxLength(this.TITLE_MAX_LENGTH)]],description:["",[S.required,S.minLength(10),S.maxLength(this.DESCRIPTION_MAX_LENGTH)]]})}isVisible=!1;isEditMode=!1;editData=null;close=new O;share=new O;update=new O;descriptionTextarea;ideaForm;isSubmitting=!1;isTitleWarning=!1;isTitleLimitReached=!1;isTitleError=!1;titleLimitMessage="";isDescriptionWarning=!1;isDescriptionLimitReached=!1;isDescriptionError=!1;descriptionLimitMessage="";TITLE_WARNING_THRESHOLD=80;TITLE_ERROR_THRESHOLD=100;DESC_WARNING_THRESHOLD=800;DESC_ERROR_THRESHOLD=1e3;TITLE_MAX_LENGTH=100;DESCRIPTION_MAX_LENGTH=1e3;textareaRows=5;textareaMinHeight=120;textareaMaxHeight=400;textareaWidth="100%";ngOnInit(){this.isEditMode&&this.editData&&this.ideaForm.patchValue({title:this.editData.title,description:this.editData.description}),this.ideaForm.get("description")?.valueChanges.subscribe(()=>{setTimeout(()=>this.adjustTextareaSize(),0)}),this.ideaForm.get("title")?.valueChanges.subscribe(()=>{this.updateTitleValidationState()}),this.ideaForm.get("description")?.valueChanges.subscribe(()=>{this.updateDescriptionValidationState()})}ngAfterViewInit(){setTimeout(()=>this.adjustTextareaSize(),0)}closeModal(){this.close.emit()}submit(){if(this.ideaForm.invalid)return;this.isSubmitting=!0;let t=this.ideaForm.value;this.isEditMode?this.update.emit(t):this.share.emit(t),setTimeout(()=>{this.ideaForm.reset(),this.isSubmitting=!1},600)}onTitleInput(t){let e=t.target;this.updateTitleValidationState()}onDescriptionInput(t){let e=t.target;this.updateDescriptionValidationState()}onKeyDown(t,e){e==="title"&&t.key==="Enter"&&t.preventDefault()}updateTitleValidationState(){let t=this.ideaForm.get("title");if(!t)return;let e=t.value?.length||0,i=t.touched||t.dirty;if(this.isTitleWarning=e>=this.TITLE_WARNING_THRESHOLD&&e<this.TITLE_MAX_LENGTH,this.isTitleLimitReached=e>=this.TITLE_MAX_LENGTH,this.isTitleError=i&&t.invalid,e>=this.TITLE_MAX_LENGTH)this.titleLimitMessage=`Maximum ${this.TITLE_MAX_LENGTH} characters reached`;else if(e>=this.TITLE_WARNING_THRESHOLD){let o=this.TITLE_MAX_LENGTH-e;this.titleLimitMessage=`${o} characters remaining`}else this.titleLimitMessage=""}updateDescriptionValidationState(){let t=this.ideaForm.get("description");if(!t)return;let e=t.value?.length||0,i=t.touched||t.dirty;if(this.isDescriptionWarning=e>=this.DESC_WARNING_THRESHOLD&&e<this.DESCRIPTION_MAX_LENGTH,this.isDescriptionLimitReached=e>=this.DESCRIPTION_MAX_LENGTH,this.isDescriptionError=i&&t.invalid,e>=this.DESCRIPTION_MAX_LENGTH)this.descriptionLimitMessage=`Maximum ${this.DESCRIPTION_MAX_LENGTH} characters reached`;else if(e>=this.DESC_WARNING_THRESHOLD){let o=this.DESCRIPTION_MAX_LENGTH-e;this.descriptionLimitMessage=`${o} characters remaining`}else this.descriptionLimitMessage="";setTimeout(()=>this.adjustTextareaSize(),0)}get titleLength(){return this.ideaForm.get("title")?.value?.length||0}get descriptionLength(){return this.ideaForm.get("description")?.value?.length||0}adjustTextareaSize(){if(!this.descriptionTextarea)return;let t=this.descriptionTextarea.nativeElement;t.style.height="auto",t.style.overflowY="hidden";let e=Math.max(this.textareaMinHeight,Math.min(t.scrollHeight,this.textareaMaxHeight));t.style.height=e+"px",t.style.width="100%"}get isFormValid(){return!this.isSubmitting&&this.ideaForm.valid&&!this.isTitleError&&!this.isDescriptionError}static \u0275fac=function(e){return new(e||n)(b(R))};static \u0275cmp=V({type:n,selectors:[["app-share-idea-modal"]],viewQuery:function(e,i){if(e&1&&Y(Me,5),e&2){let o;K(o=Q())&&(i.descriptionTextarea=o.first)}},inputs:{isVisible:"isVisible",isEditMode:"isEditMode",editData:"editData"},outputs:{close:"close",share:"share",update:"update"},decls:38,vars:47,consts:[["descriptionTextarea",""],[1,"modal-overlay",3,"click"],[1,"modal-container",3,"click"],[1,"modal-header"],[4,"ngIf"],[1,"close-btn",3,"click"],[1,"modal-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-label-row"],["for","ideaTitle"],[1,"character-counter"],["type","text","id","ideaTitle","formControlName","title","required","","placeholder","What's your idea about?",1,"form-input",3,"input","keydown","maxlength"],[1,"form-feedback"],["class","limit-message",3,"warning","limit-reached","error",4,"ngIf"],["class","error-message",4,"ngIf"],["for","ideaDescription"],[1,"textarea-wrapper"],["id","ideaDescription","formControlName","description","required","","placeholder","Describe your idea in detail...",1,"form-textarea","auto-resize",3,"input","keydown","keyup","focus","maxlength","rows"],["class","textarea-resize-handle",4,"ngIf"],[1,"form-actions"],["type","button",1,"cancel-btn",3,"click"],["type","submit",1,"submit-btn",3,"disabled"],[1,"limit-message"],["class","message-icon",4,"ngIf"],[1,"message-icon"],[1,"error-message"],[1,"textarea-resize-handle"]],template:function(e,i){if(e&1){let o=_();r(0,"div",1),h("click",function(){return m(o),g(i.closeModal())}),r(1,"div",2),h("click",function(u){return m(o),g(u.stopPropagation())}),r(2,"div",3),f(3,Se,2,0,"h2",4)(4,we,2,0,"h2",4),r(5,"button",5),h("click",function(){return m(o),g(i.closeModal())}),l(6,"\xD7"),a()(),r(7,"div",6)(8,"form",7),h("ngSubmit",function(){return m(o),g(i.submit())}),r(9,"div",8)(10,"div",9)(11,"label",10),l(12,"Title *"),a(),r(13,"div",11),l(14),a()(),r(15,"input",12),h("input",function(u){return m(o),g(i.onTitleInput(u))})("keydown",function(u){return m(o),g(i.onKeyDown(u,"title"))}),a(),r(16,"div",13),f(17,Pe,4,9,"div",14)(18,De,4,3,"div",15),a()(),r(19,"div",8)(20,"div",9)(21,"label",16),l(22,"Description *"),a(),r(23,"div",11),l(24),a()(),r(25,"div",17)(26,"textarea",18,0),h("input",function(u){return m(o),g(i.onDescriptionInput(u))})("keydown",function(u){return m(o),g(i.onKeyDown(u,"description"))})("keyup",function(){return m(o),g(i.adjustTextareaSize())})("focus",function(){return m(o),g(i.adjustTextareaSize())}),a(),f(28,ke,1,0,"div",19),a(),r(29,"div",13),f(30,Re,4,9,"div",14)(31,Ge,4,3,"div",15),a()(),r(32,"div",20)(33,"button",21),h("click",function(){return m(o),g(i.closeModal())}),l(34," Cancel "),a(),r(35,"button",22),f(36,$e,2,1,"span",4)(37,je,2,1,"span",4),a()()()()()()}if(e&2){let o,d;s(3),c("ngIf",!i.isEditMode),s(),c("ngIf",i.isEditMode),s(4),c("formGroup",i.ideaForm),s(5),v("warning",i.isTitleWarning)("limit-reached",i.isTitleLimitReached)("error",i.isTitleError),$("data-tooltip",i.titleLimitMessage),s(),j(" ",i.titleLength," / ",i.TITLE_MAX_LENGTH," "),s(),v("input-warning",i.isTitleWarning)("input-limit-reached",i.isTitleLimitReached)("input-error",i.isTitleError),c("maxlength",D(i.TITLE_MAX_LENGTH)),s(2),c("ngIf",i.titleLimitMessage),s(),c("ngIf",((o=i.ideaForm.get("title"))==null?null:o.invalid)&&(((o=i.ideaForm.get("title"))==null?null:o.dirty)||((o=i.ideaForm.get("title"))==null?null:o.touched))),s(5),v("warning",i.isDescriptionWarning)("limit-reached",i.isDescriptionLimitReached)("error",i.isDescriptionError),$("data-tooltip",i.descriptionLimitMessage),s(),j(" ",i.descriptionLength," / ",i.DESCRIPTION_MAX_LENGTH," "),s(2),v("input-warning",i.isDescriptionWarning)("input-limit-reached",i.isDescriptionLimitReached)("input-error",i.isDescriptionError),c("maxlength",D(i.DESCRIPTION_MAX_LENGTH))("rows",D(i.textareaRows)),s(2),c("ngIf",i.descriptionLength>0),s(2),c("ngIf",i.descriptionLimitMessage),s(),c("ngIf",((d=i.ideaForm.get("description"))==null?null:d.invalid)&&(((d=i.ideaForm.get("description"))==null?null:d.dirty)||((d=i.ideaForm.get("description"))==null?null:d.touched))),s(4),c("disabled",!i.ideaForm.valid||i.isSubmitting||i.isTitleError||i.isDescriptionError),s(),c("ngIf",i.isSubmitting),s(),c("ngIf",!i.isSubmitting)}},dependencies:[N,k,F,de,re,ae,se,pe,ue,le,ce],styles:['.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px)}.modal-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;width:90%;max-width:500px;max-height:90vh;overflow-y:auto;box-shadow:0 10px 30px #0003;animation:_ngcontent-%COMP%_modalAppear .3s ease-out}@keyframes _ngcontent-%COMP%_modalAppear{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #eee}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333;font-size:1.5rem;font-weight:600}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:28px;cursor:pointer;color:#666;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;color:#333}.modal-body[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:24px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500;color:#333;font-size:.95rem}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #ddd;border-radius:8px;font-size:1rem;transition:border-color .2s;box-sizing:border-box}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:violet;box-shadow:0 0 0 3px #ee82ee1a}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:120px;font-family:inherit}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.85rem;margin-top:6px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:32px;padding-top:24px;border-top:1px solid #eee}.cancel-btn[_ngcontent-%COMP%], .submit-btn[_ngcontent-%COMP%]{padding:12px 28px;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s ease;min-width:120px}.cancel-btn[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#333;border:1px solid #dee2e6}.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#e9ecef;border-color:#ced4da}.submit-btn[_ngcontent-%COMP%]{background-color:violet;color:#fff;position:relative;overflow:hidden}.submit-btn[_ngcontent-%COMP%]:enabled{background:linear-gradient(135deg,violet,purple);box-shadow:0 4px 12px #ee82ee4d}.submit-btn[_ngcontent-%COMP%]:enabled:hover{transform:translateY(-2px);box-shadow:0 6px 16px #ee82ee66;background:linear-gradient(135deg,#f091f0,#8a008a)}.submit-btn[_ngcontent-%COMP%]:enabled:active{transform:translateY(0);box-shadow:0 2px 8px #ee82ee4d}.submit-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed;opacity:.7}.submit-btn[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;width:5px;height:5px;background:#ffffff80;opacity:0;border-radius:100%;transform:scale(1) translate(-50%);transform-origin:50% 50%}.submit-btn[_ngcontent-%COMP%]:focus:not(:active):after{animation:_ngcontent-%COMP%_ripple 1s ease-out}@keyframes _ngcontent-%COMP%_ripple{0%{transform:scale(0);opacity:.5}to{transform:scale(20);opacity:0}}']})};var y=class n{constructor(t){this.http=t}apiUrl="http://localhost:5065/api/vote";convertResponse(t){return{success:t.status||!1,message:t.message||"",data:t.data}}castVote(t){let e=new C().set("groupId",t.groupId).set("ideaId",t.ideaId);return this.http.post(`${this.apiUrl}/cast-vote`,{},{params:e}).pipe(x(i=>this.convertResponse(i)))}unvote(t){let e=new C().set("voteId",t.voteId);return this.http.post(`${this.apiUrl}/unvote`,{},{params:e}).pipe(x(i=>this.convertResponse(i)))}seeVotes(t){let e=new C().set("ideaId",t.ideaId);return this.http.get(`${this.apiUrl}/see-votes`,{params:e}).pipe(x(i=>this.convertResponse(i)))}static \u0275fac=function(e){return new(e||n)(E(U))};static \u0275prov=T({token:n,factory:n.\u0275fac,providedIn:"root"})};var A=class n{constructor(t,e){this.http=t;this.voteService=e}apiUrl="http://localhost:5065/api/idea";convertResponse(t){return{success:t.status||!1,message:t.message||"",data:t.data}}getIdeasByGroup(t){let e=new C().set("groupId",t);return this.http.get(`${this.apiUrl}/view-ideas`,{params:e}).pipe(x(i=>this.convertResponse(i)))}getIdea(t,e){let i=new C().set("groupId",t).set("ideaId",e);return this.http.get(`${this.apiUrl}/open-idea`,{params:i}).pipe(x(o=>this.convertResponse(o)))}createIdea(t){let e=new C().set("groupId",t.groupId);return this.http.post(`${this.apiUrl}/create-idea`,{title:t.title,description:t.description},{params:e}).pipe(x(i=>this.convertResponse(i)))}updateIdea(t,e){return console.log("Updating idea:",t,e),this.http.put(`${this.apiUrl}/${t}`,e).pipe(x(i=>this.convertResponse(i)))}deleteIdea(t){return this.http.delete(`${this.apiUrl}/${t}`).pipe(x(e=>this.convertResponse(e)))}promoteIdea(t){let e=new C().set("groupId",t.groupId).set("ideaId",t.ideaId);return this.http.post(`${this.apiUrl}/promote-idea`,{},{params:e}).pipe(x(i=>this.convertResponse(i)))}voteForIdea(t,e){let i={groupId:t,ideaId:e};return this.voteService.castVote(i)}removeVote(t){let e={voteId:t};return this.voteService.unvote(e)}getVotesForIdea(t){let e={ideaId:t};return this.voteService.seeVotes(e)}static \u0275fac=function(e){return new(e||n)(E(U),E(y))};static \u0275prov=T({token:n,factory:n.\u0275fac,providedIn:"root"})};function qe(n,t){if(n&1){let e=_();r(0,"button",29),h("click",function(){m(e);let o=p();return g(o.openShareModal())}),r(1,"span",30),l(2,"+"),a(),l(3," Share Idea "),a()}}function Be(n,t){n&1&&(r(0,"div",31),P(1,"div",32),r(2,"p"),l(3,"Loading ideas..."),a()())}function Xe(n,t){if(n&1){let e=_();r(0,"div",33)(1,"div",34)(2,"div",35),l(3,"\u{1F4A1}"),a(),r(4,"h3"),l(5,"No ideas yet"),a(),r(6,"p"),l(7,"Be the first to share an idea with the group!"),a(),r(8,"button",29),h("click",function(){m(e);let o=p();return g(o.openShareModal())}),r(9,"span",30),l(10,"+"),a(),l(11," Share Idea "),a()()()}}function We(n,t){n&1&&(r(0,"span",54),l(1,"\u2714 Promoted"),a())}function Ye(n,t){if(n&1){let e=_();r(0,"button",55),h("click",function(o){m(e);let d=p().$implicit,u=p(2);return o.stopPropagation(),g(u.onPromoteIdea(d,o))}),r(1,"span",56),l(2,"\u{1F680}"),a()()}if(n&2){let e=p().$implicit,i=p(2);c("disabled",i.isPromoting&&i.currentlyPromotingIdeaId===e.id)}}function Ke(n,t){if(n&1){let e=_();r(0,"button",57),h("click",function(o){m(e);let d=p().$implicit,u=p(2);return o.stopPropagation(),g(u.onDeleteIdea(d.id,o))}),r(1,"span",58),l(2,"\u2715"),a()()}}function Qe(n,t){if(n&1&&(r(0,"span",59),l(1),a()),n&2){let e=p().$implicit;s(),I(" ",e.voteCount||0," ")}}function Je(n,t){n&1&&(r(0,"span",60),l(1,"Read more"),a())}function Ze(n,t){n&1&&(r(0,"div",61),P(1,"div",62),a())}function et(n,t){if(n&1){let e=_();X(0),r(1,"div",38),h("click",function(){let o=m(e).$implicit,d=p(2);return g(d.selectIdea(o))}),r(2,"div",39)(3,"div",40)(4,"h3",41),l(5),a(),f(6,We,2,0,"span",42),r(7,"div",43),f(8,Ye,3,1,"button",44)(9,Ke,3,0,"button",45),a()(),r(10,"div",46)(11,"button",47),h("click",function(o){let d=m(e).$implicit,u=p(2);return g(d.userVoted?u.onUnvote(d,o):u.onVote(d.id))}),r(12,"span",48),l(13,"\u2B9D"),a(),f(14,Qe,2,1,"span",49),a(),r(15,"span",50),l(16),a()()(),r(17,"p",51),l(18),J(19,"slice"),f(20,Je,2,0,"span",52),a()(),f(21,Ze,2,0,"div",53),W()}if(n&2){let e=t.$implicit,i=t.last,o=p(2);s(),v("selected",(o.selectedIdea==null?null:o.selectedIdea.id)===e.id)("promoted",e.isPromotedToProject),s(4),M(e.title),s(),c("ngIf",e.isPromotedToProject),s(2),c("ngIf",o.isGroupCreator()&&!e.isPromotedToProject),s(),c("ngIf",o.isUserIdeaOwner(e)),s(2),v("voted",e.userVoted),c("disabled",o.isVoting||o.isUnvoting)("title",e.userVoted?"Remove your vote":"Vote for this idea"),s(3),c("ngIf",o.isGroupCreator()),s(2),M(o.formatIdeaDate(e.createdAt)),s(2),I(" ",e.description.length>150?Z(19,17,e.description,0,150)+"...":e.description," "),s(2),c("ngIf",e.description.length>150),s(),c("ngIf",!i)}}function tt(n,t){if(n&1&&(r(0,"div",36),f(1,et,22,21,"ng-container",37),a()),n&2){let e=p();s(),c("ngForOf",e.ideas)("ngForTrackBy",e.trackById)}}function it(n,t){n&1&&(r(0,"span",83),l(1,"\u2714 Promoted"),a())}function ot(n,t){if(n&1){let e=_();r(0,"button",84),h("click",function(){m(e);let o=p(2);return g(o.startEditing())}),l(1,"\u270E"),a()}}function nt(n,t){if(n&1){let e=_();r(0,"button",55),h("click",function(o){m(e);let d=p(2);return g(d.onPromoteIdea(d.selectedIdea,o))}),l(1," \u{1F680} "),a()}if(n&2){let e=p(2);c("disabled",e.isPromoting)}}function rt(n,t){if(n&1){let e=_();r(0,"button",85),h("click",function(o){m(e);let d=p(2);return g(d.onViewVoters(d.selectedIdea,o))}),l(1," \u{1F441}\uFE0F "),a()}}function at(n,t){if(n&1){let e=_();r(0,"button",86),h("click",function(){m(e);let o=p(2);return g(o.onDeleteIdea(o.selectedIdea.id))}),l(1,"\u2715"),a()}}function st(n,t){if(n&1&&(r(0,"span",59),l(1),a()),n&2){let e=p(2);s(),M(e.selectedIdea.voteCount||0)}}function dt(n,t){n&1&&(r(0,"span",95),l(1,"(You)"),a())}function lt(n,t){n&1&&(r(0,"span"),l(1,"Group Creator & Idea Owner"),a())}function ct(n,t){n&1&&(r(0,"span"),l(1,"Group Creator"),a())}function pt(n,t){n&1&&(r(0,"span"),l(1,"Idea Owner"),a())}function ut(n,t){n&1&&(r(0,"span"),l(1,"Member"),a())}function mt(n,t){if(n&1&&(r(0,"div",80)(1,"h4",87),l(2,"Author"),a(),r(3,"div",88)(4,"div",89),l(5),a(),r(6,"div",90)(7,"div",91),l(8),f(9,dt,2,0,"span",92),a(),r(10,"div",93),f(11,lt,2,0,"span",94)(12,ct,2,0,"span",94)(13,pt,2,0,"span",94)(14,ut,2,0,"span",94),a()()()()),n&2){let e=p(2);s(5),M((e.selectedIdea.userName==null?null:e.selectedIdea.userName.charAt(0))||"U"),s(3),I("",e.selectedIdea.userName||"Unknown User"," "),s(),c("ngIf",e.isUserIdeaOwner(e.selectedIdea)),s(2),c("ngIf",e.isGroupCreator()&&e.isUserIdeaOwner(e.selectedIdea)),s(),c("ngIf",e.isGroupCreator()&&!e.isUserIdeaOwner(e.selectedIdea)),s(),c("ngIf",!e.isGroupCreator()&&e.isUserIdeaOwner(e.selectedIdea)),s(),c("ngIf",!e.isGroupCreator()&&!e.isUserIdeaOwner(e.selectedIdea))}}function gt(n,t){if(n&1){let e=_();r(0,"div",63)(1,"div",64)(2,"h2",65),l(3,"Idea Details"),a(),r(4,"button",66),h("click",function(){m(e);let o=p();return g(o.selectedIdea=null)}),r(5,"span"),l(6,"\xD7"),a()()(),r(7,"div",67)(8,"div",68)(9,"div",69)(10,"div",70)(11,"h3",71),l(12),f(13,it,2,0,"span",72),a(),r(14,"div",73),f(15,ot,2,0,"button",74)(16,nt,2,1,"button",44)(17,rt,2,0,"button",75)(18,at,2,0,"button",76),r(19,"button",77),h("click",function(o){m(e);let d=p();return g(d.selectedIdea.userVoted?d.onUnvote(d.selectedIdea,o):d.onVote(d.selectedIdea.id))}),l(20," \u2B9D "),f(21,st,2,1,"span",49),a()()(),r(22,"div",78)(23,"div",79),l(24),a()()(),r(25,"div",80)(26,"p",81),l(27),a()(),f(28,mt,15,7,"div",82),a()()()}if(n&2){let e=p();s(12),I("",e.selectedIdea.title," "),s(),c("ngIf",e.selectedIdea.isPromotedToProject),s(2),c("ngIf",e.isUserIdeaOwner(e.selectedIdea)),s(),c("ngIf",e.isGroupCreator()&&!e.selectedIdea.isPromotedToProject),s(),c("ngIf",e.isGroupCreator()&&e.selectedIdea.voteCount>0),s(),c("ngIf",e.isUserIdeaOwner(e.selectedIdea)),s(),v("voted",e.selectedIdea.userVoted),c("disabled",e.isVoting||e.isUnvoting),s(2),c("ngIf",e.isGroupCreator()),s(3),M(e.formatIdeaDate(e.selectedIdea.createdAt)),s(3),M(e.selectedIdea.description),s(),c("ngIf",e.selectedIdea.userName)}}function ft(n,t){if(n&1){let e=_();r(0,"app-share-idea-modal",96),h("close",function(){m(e);let o=p();return g(o.closeShareModal())})("share",function(o){m(e);let d=p();return g(d.onShareIdea(o))})("update",function(o){m(e);let d=p();return g(d.onUpdateIdeaFromModal(o))}),a()}if(n&2){let e=p();c("isVisible",e.showShareModal)("isEditMode",e.isEditMode)("editData",e.modalEditData)}}var _e=class n{constructor(t,e,i,o,d,u,Ie,H){this.route=t;this.router=e;this.ideasService=i;this.groupsService=o;this.authService=d;this.voteService=u;this.dialog=Ie;this.fb=H}groupId="";groupName="";ideas=[];isLoading=!1;isSubmitting=!1;showShareModal=!1;currentUserId="";selectedIdea=null;membersCount="";isVoting=!1;isUnvoting=!1;isViewingVoters=!1;selectedIdeaForVoters=null;votersList=[];groupCreatorId="";isGroupCreatorFromState=void 0;groupCreatorIdFromState="";isPromoting=!1;currentlyPromotingIdeaId=null;groupMembers=[];isEditMode=!1;modalEditData={id:"",title:"",description:""};routeSub=new B;ngOnInit(){console.log("=== INITIALIZING IDEAS COMPONENT ==="),this.currentUserId=this.authService.getCurrentUserId(),console.log("Current User ID:",this.currentUserId),console.log("Browser history state:",history.state);let t=this.router.getCurrentNavigation();if(console.log("=== NAVIGATION DEBUG ==="),console.log("Navigation exists:",!!t),console.log("Navigation extras:",t?.extras),console.log("Navigation state:",t?.extras?.state),t?.extras?.state){let e=t.extras.state;this.isGroupCreatorFromState=e.isGroupCreator||!1,this.groupName=e.groupName||this.groupName,this.groupCreatorIdFromState=e.groupCreatorId||"",this.groupCreatorId=this.groupCreatorIdFromState,console.log("RECEIVED ROUTE STATE:",{isGroupCreator:this.isGroupCreatorFromState,groupName:this.groupName,groupCreatorId:this.groupCreatorIdFromState,fullState:e})}else console.log("NO ROUTE STATE from navigation"),history.state&&history.state.groupCreatorId&&(console.log("Found state in browser history:",history.state),this.isGroupCreatorFromState=history.state.isGroupCreator,this.groupName=history.state.groupName||this.groupName,this.groupCreatorIdFromState=history.state.groupCreatorId,this.groupCreatorId=this.groupCreatorIdFromState);this.routeSub=this.route.params.subscribe(e=>{this.groupId=e.groupId,console.log("Group ID from route:",this.groupId),console.log("=== CURRENT STATE ===",{groupCreatorId:this.groupCreatorId,groupCreatorIdFromState:this.groupCreatorIdFromState,isGroupCreatorFromState:this.isGroupCreatorFromState,groupName:this.groupName}),this.groupCreatorId?console.log("Using existing groupCreatorId:",this.groupCreatorId):(console.log("No groupCreatorId, loading from API..."),this.loadGroupInfo()),this.loadGroupMembers(),this.loadIdeas()})}ngOnDestroy(){this.routeSub.unsubscribe()}openEditModal(t){this.isEditMode=!0,this.modalEditData=G({},t)}selectIdea(t){console.log("Selecting idea:",t),this.selectedIdea=t}onUpdateIdeaFromModal(t){if(!this.selectedIdea){console.log("No idea selected for modal update");return}console.log("Updating idea from modal:",t);let e={title:t.title,description:t.description,status:this.selectedIdea.status??"open"};this.ideasService.updateIdea(this.selectedIdea.id,e).subscribe({next:i=>{if(i.success){console.log("Idea updated from modal successfully");let o=this.ideas.findIndex(d=>d.id===this.selectedIdea.id);o!==-1&&(this.ideas[o].title=t.title,this.ideas[o].description=t.description,this.ideas[o].updatedAt=new Date,this.ideas=[...this.ideas]),this.selectedIdea.title=t.title,this.selectedIdea.description=t.description,this.selectedIdea.updatedAt=new Date,this.showShareModal=!1,this.isEditMode=!1,this.modalEditData=null,alert("Idea updated successfully!")}else alert(`Failed to update idea: ${i.message}`)},error:i=>{console.error("Error updating idea from modal:",i),alert("An error occurred while updating the idea.")}})}loadGroupInfo(){if(this.groupCreatorIdFromState&&this.groupName){console.log("Skipping loadGroupInfo - already have data from route state"),this.groupCreatorId=this.groupCreatorIdFromState;return}this.groupsService.getGroups().subscribe({next:t=>{if(console.log("=== GROUP INFO RESPONSE ==="),t.success&&t.data){let e=t.data.find(i=>i.id===this.groupId);e&&(this.groupName||(this.groupName=e.name),this.groupCreatorId||(this.groupCreatorId=e.createdByUserId||e.userId||e.createdBy||e.ownerId||""),console.log("Group info loaded:",{groupName:this.groupName,groupCreatorId:this.groupCreatorId,fromState:!!this.groupCreatorIdFromState}))}},error:t=>{console.error("Error loading group info:",t)}})}openMembersModal(){console.log("Opening members modal for group:",this.groupId),this.groupsService.getGroupMembers(this.groupId).subscribe({next:t=>{let e=t.data||[];this.dialog.open(fe,{width:"600px",maxHeight:"90vh",data:{group:{id:this.groupId,name:this.groupName,memberCount:e.length,members:e}},panelClass:"custom-modal"})}})}formatIdeaDate(t){if(!t)return"Unknown date";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid date"}}loadGroupMembers(){if(!this.groupId){console.warn("Cannot load members: groupId is missing");return}this.groupsService.getGroupMembers(this.groupId).subscribe({next:t=>{t.success?(console.log("Members fetched:",t.data),this.groupMembers=t.data||[],this.membersCount=`${this.groupMembers.length}`):(console.warn("Failed to fetch members:",t.message),this.groupMembers=[],this.membersCount="0")},error:t=>{console.error("Error fetching members:",t),this.groupMembers=[],this.membersCount="0"}})}loadIdeas(){this.isLoading=!0,this.ideasService.getIdeasByGroup(this.groupId).subscribe({next:t=>w(this,null,function*(){if(this.isLoading=!1,console.log("=== LOADING IDEAS ==="),console.log("API Response:",t),t.success&&t.data){if(this.ideas=t.data.map(e=>(console.log(`Mapping idea "${e.title}":`,{id:e.id,isPromotedToProject:e.isPromotedToProject,isDeleted:e.isDeleted}),{id:e.id?.toString()||"",title:e.title||"",description:e.description||"",UserId:e.userId||e.UserId||"",userId:e.userId||e.UserId||"",groupId:this.groupId,isPromotedToProject:e.isPromotedToProject||!1,isDeleted:e.isDeleted||!1,createdAt:new Date(e.createdAt||new Date),updatedAt:new Date(e.updatedAt||new Date),status:e.status||"Open",deletedAt:e.deletedAt?new Date(e.deletedAt):void 0,voteCount:0,commentCount:0,userVoted:!1,userName:e.userName||"",userVoteId:void 0,groupName:e.name||"",name:e.name||""})),console.log(`Mapped ${this.ideas.length} ideas`),console.log("Promotion status:",this.ideas.map(e=>({title:e.title,promoted:e.isPromotedToProject}))),this.ideas.length>0?yield this.fetchAndUpdateVoteCounts():console.log("No ideas to fetch vote counts for"),this.selectedIdea){let e=this.ideas.find(i=>i.id===this.selectedIdea?.id);e&&(this.selectedIdea=e,console.log("Updated selected idea with promotion status:",this.selectedIdea.isPromotedToProject))}console.log("=== IDEAS LOADING COMPLETE ===")}else console.warn("Failed to load ideas:",t.message),this.ideas=[]}),error:t=>{this.isLoading=!1,console.error("Error loading ideas:",t),this.ideas=[]}})}isUserIdeaOwner(t){if(!t||!this.currentUserId)return console.log("Ownership check failed: missing data",{hasIdea:!!t,hasCurrentUserId:!!this.currentUserId,ideaUserId:t?.userId,currentUserId:this.currentUserId}),!1;let e=t.userId;if(!e)return console.log("No userId found in idea:",t),!1;let i=e.toString().trim().toLowerCase(),o=this.currentUserId.toString().trim().toLowerCase(),d=i===o;return console.log(`Ownership check for "${t.title}":`,{ideaUserId:e,currentUserId:this.currentUserId,normalizedIdeaUserId:i,normalizedCurrentUserId:o,isOwner:d}),d}isGroupCreator(){if(console.log("=== isGroupCreator() CALLED ==="),this.isGroupCreatorFromState!==void 0)return console.log("Using pre-determined group creator status from route state:",this.isGroupCreatorFromState),console.log("Route state values:",{isGroupCreatorFromState:this.isGroupCreatorFromState,groupCreatorIdFromState:this.groupCreatorIdFromState,currentUserId:this.currentUserId}),this.isGroupCreatorFromState;if(console.log("No route state, checking via IDs..."),console.log("Current values:",{groupCreatorId:this.groupCreatorId,currentUserId:this.currentUserId,hasGroupCreatorId:!!this.groupCreatorId,hasCurrentUserId:!!this.currentUserId}),!this.groupCreatorId||!this.currentUserId)return console.log("Group creator check failed - missing IDs:",{hasGroupCreatorId:!!this.groupCreatorId,hasCurrentUserId:!!this.currentUserId,groupCreatorId:this.groupCreatorId,currentUserId:this.currentUserId}),!1;let t=this.groupCreatorId.toString().trim().toLowerCase(),e=this.currentUserId.toString().trim().toLowerCase(),i=t===e;return console.log("Group creator check (calculated):",{groupCreatorId:this.groupCreatorId,currentUserId:this.currentUserId,normalizedGroupCreatorId:t,normalizedCurrentUserId:e,isCreator:i}),i}openShareModal(){this.showShareModal=!0}closeShareModal(){this.showShareModal=!1,this.isEditMode=!1,this.modalEditData=null}onShareIdea(t){this.isSubmitting=!0;let e=q(G({},t),{groupId:this.groupId});this.ideasService.createIdea(e).subscribe({next:i=>{this.isSubmitting=!1,i.success?(this.closeShareModal(),this.loadIdeas(),console.log("Idea created successfully!")):alert(`Failed to create idea: ${i.message}`)},error:i=>{this.isSubmitting=!1,console.error("Error creating idea:",i),alert("An error occurred while creating the idea.")}})}openDescriptionModal(t){alert(`Full Description:

${t.description}`)}onViewIdea(t){this.ideasService.getIdea(this.groupId,t).subscribe({next:e=>{e.success&&e.data&&alert(`Idea Details:

Title: ${e.data.title}

Description: ${e.data.description}

Created: ${new Date(e.data.createdAt).toLocaleDateString()}`)},error:e=>{console.error("Error loading idea:",e)}})}trackById(t,e){return e.id}onVote(t){console.log(`=== VOTING FOR IDEA ${t} ===`),this.isVoting=!0,this.ideasService.voteForIdea(this.groupId,t).subscribe({next:e=>{if(this.isVoting=!1,console.log("Vote response:",e),e.success&&e.data){let i=e.data?.id,o=this.ideas.find(d=>d.id===t);o&&(o.userVoted=!0,o.userVoteId=i?.toString(),o.voteCount=(o.voteCount||0)+1,console.log(`Updated idea "${o.title}":`,{userVoted:o.userVoted,voteCount:o.voteCount,userVoteId:o.userVoteId})),this.selectedIdea&&this.selectedIdea.id===t&&(this.selectedIdea.userVoted=!0,this.selectedIdea.voteCount=(this.selectedIdea.voteCount||0)+1,i&&(this.selectedIdea.userVoteId=i.toString())),console.log("\u2713 Vote successful!")}else alert(`Failed to vote: ${e.message}`)},error:e=>{this.isVoting=!1,console.error("Error voting:",e),alert("An error occurred while voting.")}})}onUnvote(t,e){if(e&&e.stopPropagation(),console.log(`=== UNVOTING FOR IDEA ${t.id} ===`),!t.userVoteId){console.error("Cannot unvote: No vote ID found"),alert("Cannot unvote: No vote ID found. Please refresh the page.");return}this.isUnvoting=!0,this.ideasService.removeVote(t.userVoteId).subscribe({next:i=>{this.isUnvoting=!1,console.log("Unvote response:",i),i.success?(t.userVoted=!1,t.voteCount=Math.max(0,(t.voteCount||1)-1),t.userVoteId=void 0,this.selectedIdea&&this.selectedIdea.id===t.id&&(this.selectedIdea.userVoted=!1,this.selectedIdea.voteCount=t.voteCount,this.selectedIdea.userVoteId=void 0),console.log("\u2713 Unvote successful!")):alert(`Failed to unvote: ${i.message}`)},error:i=>{this.isUnvoting=!1,console.error("Error unvoting:",i),i.status===404?(alert("Vote not found. It may have already been removed."),t.userVoted=!1,t.userVoteId=void 0):alert("An error occurred while unvoting.")}}),this.isUnvoting=!0,this.ideasService.removeVote(t.userVoteId).subscribe({next:i=>{this.isUnvoting=!1,console.log("Unvote response:",i),i.success?(t.userVoted=!1,t.voteCount=Math.max(0,(t.voteCount||1)-1),t.userVoteId=void 0,this.selectedIdea&&this.selectedIdea.id===t.id&&(this.selectedIdea.userVoted=!1,this.selectedIdea.voteCount=t.voteCount,this.selectedIdea.userVoteId=void 0),this.checkUserVotesForAllIdeas().then(()=>{console.log("Vote status refreshed after unvoting")}),console.log("\u2713 Unvote successful!")):alert(`Failed to unvote: ${i.message}`)},error:i=>{this.isUnvoting=!1,console.error("Error unvoting:",i),i.status===404?(alert("Vote not found. It may have already been removed."),t.userVoted=!1,t.userVoteId=void 0):alert("An error occurred while unvoting.")}})}onViewVoters(t,e){e&&e.stopPropagation(),this.isViewingVoters=!0,this.selectedIdeaForVoters=t,this.ideasService.getVotesForIdea(t.id).subscribe({next:i=>{this.isViewingVoters=!1,i.success&&i.data?(this.votersList=i.data,this.showVotersModal(t,i.data)):alert(`Failed to get voters: ${i.message}`)},error:i=>{this.isViewingVoters=!1,console.error("Error fetching voters:",i)}})}checkUserVotesForAllIdeas(){return w(this,null,function*(){if(console.log("=== CHECKING USER VOTES FOR ALL IDEAS ==="),console.log("Current User ID:",this.currentUserId),!this.currentUserId){console.warn("No current user ID, skipping vote check");return}let t=this.ideas.map((e,i)=>w(this,null,function*(){console.log(`[${i+1}/${this.ideas.length}] Checking votes for idea "${e.title}"...`);try{let o=yield this.getUserVoteForIdea(e.id);o.hasVoted?(e.userVoted=!0,e.userVoteId=o.voteId,console.log(`\u2713 User has voted for "${e.title}"`,{voteId:o.voteId,voteTime:o.voteTime})):(e.userVoted=!1,e.userVoteId=void 0,console.log(`\u2717 User has NOT voted for "${e.title}"`))}catch(o){console.error(`Error checking votes for idea ${e.id}:`,o),e.userVoted=!1,e.userVoteId=void 0}return e}));yield Promise.all(t),this.ideas=[...this.ideas],console.log("=== VOTE CHECK COMPLETE ==="),this.logVoteStatus()})}getUserVoteForIdea(t){return new Promise((e,i)=>{this.ideasService.getVotesForIdea(t).subscribe({next:o=>{if(o.success&&o.data&&Array.isArray(o.data)){console.log(`Votes for idea ${t}:`,{count:o.data.length,voters:o.data.map(u=>({userId:u.userId,userName:u.userName,voteId:u.voteId}))});let d=o.data.find(u=>{let H=(u.userId||u.UserId)?.toString()===this.currentUserId,ve=!u.isDeleted;return H&&ve});d?(console.log(`Found user vote for idea ${t}:`,{voteId:d.voteId,time:d.time}),e({hasVoted:!0,voteId:d.voteId?.toString(),voteTime:d.time})):(console.log(`No active vote found for current user on idea ${t}`),e({hasVoted:!1}))}else console.log(`No votes found for idea ${t} or invalid response`),e({hasVoted:!1})},error:o=>{console.error(`Error fetching votes for idea ${t}:`,o),i(o)}})})}logVoteStatus(){console.log("=== CURRENT VOTE STATUS ==="),this.ideas.forEach((e,i)=>{console.log(`${i+1}. "${e.title}":`,{voted:e.userVoted,voteId:e.userVoteId,totalVotes:e.voteCount})});let t=this.ideas.filter(e=>e.userVoted).length;console.log(`Summary: ${t}/${this.ideas.length} ideas voted`)}showVotersModal(t,e){let i=`Voters for "${t.title}":

`;e.length===0?i+="No votes yet":e.forEach((o,d)=>{let u=new Date(o.time).toLocaleString();i+=`${d+1}. ${o.userName} (${o.userEmail})
`,i+=`   Voted: ${u}

`}),alert(i)}closeVotersView(){this.selectedIdeaForVoters=null,this.votersList=[]}startEditing(){this.showShareModal=!0,this.isEditMode=!0,this.modalEditData={title:this.selectedIdea.title,description:this.selectedIdea.description}}fetchAndUpdateVoteCounts(){return w(this,null,function*(){console.log("=== FETCHING VOTE COUNTS ===");let t=this.ideas.map(e=>w(this,null,function*(){try{let i=yield this.ideasService.getVotesForIdea(e.id).toPromise();if(i?.success&&i.data){let o=i.data.filter(u=>!u.isDeleted);e.voteCount=o.length,console.log(`Idea "${e.title}": ${o.length} votes`);let d=o.find(u=>u.userId?.toString()===this.currentUserId);d&&(e.userVoted=!0,e.userVoteId=d.voteId?.toString(),console.log(`  - User has voted (voteId: ${d.voteId})`))}else e.voteCount=0,console.log(`Idea "${e.title}": 0 votes (no data or error)`)}catch(i){console.error(`Error fetching votes for idea ${e.id}:`,i),e.voteCount=0}return e}));yield Promise.all(t),console.log("=== VOTE COUNTS UPDATED ==="),this.ideas=[...this.ideas],console.log("Final vote counts:"),this.ideas.forEach((e,i)=>{console.log(`${i+1}. "${e.title}": ${e.voteCount} votes, userVoted: ${e.userVoted}`)})})}onPromoteIdea(t,e){if(e&&e.stopPropagation(),console.log("=== PROMOTING IDEA TO PROJECT ==="),console.log("Current promotion status:",t.isPromotedToProject),t.isPromotedToProject){console.log("Idea already promoted, skipping"),alert("This idea is already promoted to a project!");return}if(!confirm(`Are you sure you want to promote "${t.title}" to a project?

This will move the idea to the projects section.`))return;this.isPromoting=!0,this.currentlyPromotingIdeaId=t.id;let i={ideaId:t.id,groupId:this.groupId};console.log("Calling backend with:",i),this.ideasService.promoteIdea(i).subscribe({next:o=>{this.isPromoting=!1,this.currentlyPromotingIdeaId=null,console.log("Promote response from backend:",o),o.success?(t.isPromotedToProject=!0,t.status="Promoted",this.selectedIdea&&this.selectedIdea.id===t.id&&(this.selectedIdea.isPromotedToProject=!0,this.selectedIdea.status="Promoted"),this.ideas=[...this.ideas],alert(`Idea "${t.title}" has been promoted to a project!

It will now appear in the projects section.`),console.log(`Idea "${t.title}" promoted successfully`)):alert(`Failed to promote idea: ${o.message}`)},error:o=>{this.isPromoting=!1,this.currentlyPromotingIdeaId=null,console.error("Error promoting idea:",o),o.status===401?alert("Please login to promote ideas."):o.status===403?alert("You do not have permission to promote ideas. Only group creators can promote ideas."):o.status===404?alert("Idea not found."):alert("An error occurred while promoting the idea.")}})}onDeleteIdea(t,e){e&&(e.stopPropagation(),console.log("Delete button clicked for idea ID:",t)),console.log("==== DELETE ACTION STARTED ===="),console.log("Idea ID to delete:",t),console.log("Idea ID type:",typeof t),console.log("Idea ID value:",t),confirm("Are you sure you want to delete this idea? This action cannot be undone.")&&(console.log("Deleting idea ID:",t),this.ideasService.deleteIdea(t).subscribe({next:i=>{if(console.log("Delete response:",i),i.success){console.log("Delete successful");let o=this.ideas.findIndex(d=>d.id===t);o!==-1&&(this.ideas.splice(o,1),this.ideas=[...this.ideas]),this.selectedIdea&&this.selectedIdea.id===t&&(this.selectedIdea=null,this.isEditMode=!1,console.log("Closed details panel for deleted idea")),this.ideas.length===0&&console.log("All ideas deleted, showing empty state"),alert("Idea deleted successfully!")}else alert(`Failed to delete idea: ${i.message}`)},error:i=>{console.error("Error deleting idea:",i),alert("An error occurred while deleting the idea.")}}))}static \u0275fac=function(e){return new(e||n)(b(ie),b(oe),b(A),b(ge),b(ne),b(y),b(me),b(R))};static \u0275cmp=V({type:n,selectors:[["app-ideas"]],decls:40,vars:10,consts:[[1,"ideas-container"],[1,"ideas-list-panel"],[1,"ideas-header"],[1,"header-content"],[1,"header-text"],[1,"page-title"],[1,"page-subtitle"],[1,"header-actions"],[1,"members-section",3,"click"],[1,"members-icon"],[1,"members-info"],[1,"members-count"],[1,"members-label"],["class","create-idea-btn",3,"click",4,"ngIf"],[1,"section-header"],[1,"section-title"],[1,"section-sort"],[1,"sort-label"],[1,"sort-options"],[1,"sort-option","active"],[1,"sort-separator"],[1,"sort-option"],["class","loading",4,"ngIf"],["class","no-ideas",4,"ngIf"],["class","ideas-list",4,"ngIf"],[1,"leave-group-section"],[1,"leave-group-btn"],["class","idea-details-panel",4,"ngIf"],[3,"isVisible","isEditMode","editData","close","share","update",4,"ngIf"],[1,"create-idea-btn",3,"click"],[1,"create-icon"],[1,"loading"],[1,"spinner"],[1,"no-ideas"],[1,"no-ideas-content"],[1,"no-ideas-icon"],[1,"ideas-list"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"idea-card",3,"click"],[1,"idea-card-header"],[1,"idea-header-top"],[1,"idea-title"],["class","promoted-badge-top-right",4,"ngIf"],[1,"idea-header-actions"],["class","promote-btn","title","Promote to Project",3,"disabled","click",4,"ngIf"],["class","delete-btn","title","Delete idea",3,"click",4,"ngIf"],[1,"idea-card-meta"],[1,"vote-toggle-btn",3,"click","disabled","title"],[1,"vote-icon"],["class","vote-count",4,"ngIf"],[1,"idea-date"],[1,"idea-description"],["class","read-more",4,"ngIf"],["class","card-divider",4,"ngIf"],[1,"promoted-badge-top-right"],["title","Promote to Project",1,"promote-btn",3,"click","disabled"],[1,"promote-icon"],["title","Delete idea",1,"delete-btn",3,"click"],[1,"delete-icon"],[1,"vote-count"],[1,"read-more"],[1,"card-divider"],[1,"divider-line"],[1,"idea-details-panel"],[1,"details-panel-header"],[1,"details-title"],["title","Close details",1,"close-details-btn",3,"click"],[1,"details-panel-content"],[1,"view-mode"],[1,"details-idea-header"],[1,"details-row-1"],[1,"details-idea-title"],["class","promoted-badge",4,"ngIf"],[1,"details-actions-right"],["class","edit-btn","title","Edit idea",3,"click",4,"ngIf"],["class","view-voters-btn","title","View voters",3,"click",4,"ngIf"],["class","details-delete-btn","title","Delete idea",3,"click",4,"ngIf"],["title","Vote for this idea",1,"vote-toggle-btn","details-vote-btn",3,"click","disabled"],[1,"details-row-2"],[1,"details-date"],[1,"details-section"],[1,"details-idea-description"],["class","details-section",4,"ngIf"],[1,"promoted-badge"],["title","Edit idea",1,"edit-btn",3,"click"],["title","View voters",1,"view-voters-btn",3,"click"],["title","Delete idea",1,"details-delete-btn",3,"click"],[1,"details-section-title"],[1,"author-info"],[1,"author-avatar"],[1,"author-details"],[1,"author-name"],["class","you-badge",4,"ngIf"],[1,"author-role"],[4,"ngIf"],[1,"you-badge"],[3,"close","share","update","isVisible","isEditMode","editData"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"header",2)(3,"div",3)(4,"div",4)(5,"h1",5),l(6),a(),r(7,"p",6),l(8,"Explore and collaborate on ideas within the group"),a()(),r(9,"div",7)(10,"div",8),h("click",function(){return i.openMembersModal()}),r(11,"div",9),l(12,"\u{1F465}"),a(),r(13,"div",10)(14,"div",11),l(15),a(),r(16,"div",12),l(17,"Click to view"),a()()(),f(18,qe,4,0,"button",13),a()()(),r(19,"div",14)(20,"h2",15),l(21,"Ideas"),a(),r(22,"div",16)(23,"span",17),l(24,"Sort by:"),a(),r(25,"div",18)(26,"button",19),l(27,"Top Voted"),a(),r(28,"div",20),l(29,"|"),a(),r(30,"button",21),l(31,"Newest"),a()()()(),f(32,Be,4,0,"div",22)(33,Xe,12,0,"div",23)(34,tt,2,2,"div",24),r(35,"div",25)(36,"button",26),l(37," Leave Group "),a()()(),f(38,gt,29,13,"div",27),a(),f(39,ft,1,3,"app-share-idea-modal",28)),e&2&&(v("split-view",i.selectedIdea),s(6),M(i.groupName||"Loading group name..."),s(9),I("",i.membersCount||0," members"),s(3),c("ngIf",!i.showShareModal),s(14),c("ngIf",i.isLoading),s(),c("ngIf",!i.isLoading&&i.ideas.length===0&&!i.showShareModal),s(),c("ngIf",!i.isLoading&&i.ideas.length>0),s(4),c("ngIf",i.selectedIdea),s(),c("ngIf",i.showShareModal))},dependencies:[N,ee,k,F,L,te],styles:[".ideas-container[_ngcontent-%COMP%]{max-width:1650px;margin:0 auto;padding:20px;background:#fff;min-height:80vh;width:100%;transition:all .35s ease;display:flex;flex-direction:row;align-items:stretch;gap:20px}.ideas-list-panel[_ngcontent-%COMP%]{flex:1;min-width:0;border-right:1px solid #e0e0e0;padding-right:20px;word-wrap:break-word}.idea-details-panel[_ngcontent-%COMP%]{position:relative;flex:0 0 50%;background:#fff;border-left:2px solid #e0e0e0;box-shadow:-4px 0 12px #00000014;border-radius:8px;padding:24px;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;transition:all .3s ease;word-wrap:break-word}.details-panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:2px solid #f0f0f0;padding-bottom:12px;margin-bottom:20px}.details-idea-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.details-row-1[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.details-actions-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.details-row-2[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;font-size:small;color:purple;margin-bottom:20px}.details-title[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#333}.details-section[_ngcontent-%COMP%]{margin-bottom:20px}.details-section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#555;margin-bottom:8px}.details-idea-description[_ngcontent-%COMP%]{color:#444;line-height:1.6;font-size:15px}.details-actions[_ngcontent-%COMP%]{margin-top:auto;padding-top:20px;border-top:1px solid #eee;display:flex;gap:12px}.details-action-btn[_ngcontent-%COMP%]{flex:1;padding:10px;border-radius:6px;font-weight:600;cursor:pointer;transition:.2s}.details-action-btn.delete[_ngcontent-%COMP%]{background:#fff2f0;color:#000;border:1px solid #ee82ee}.details-action-btn.delete[_ngcontent-%COMP%]:hover{background:purple;color:#fff}.ideas-header[_ngcontent-%COMP%]{margin-bottom:30px}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:15px;margin-bottom:20px}.header-text[_ngcontent-%COMP%]{flex:1}.page-title[_ngcontent-%COMP%]{font-size:32px;font-weight:700;margin:0 0 8px;color:#333}.page-subtitle[_ngcontent-%COMP%]{color:#666;margin:0;font-size:16px;line-height:1.5}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;flex-shrink:0}.members-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 16px;background:#fff;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:all .2s;min-width:140px}.members-section[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-color:#1a73e8}.members-icon[_ngcontent-%COMP%]{font-size:20px;width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:#f0f7ff;border-radius:50%}.members-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.members-count[_ngcontent-%COMP%]{font-weight:600;color:#333;font-size:14px}.members-label[_ngcontent-%COMP%]{font-size:12px;color:#666}.create-idea-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,violet,purple);color:#fff;border:none;border-radius:8px;padding:14px 28px;font-size:1.1rem;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:10px;transition:all .3s ease;box-shadow:0 4px 12px #ee82ee4d;position:relative;overflow:hidden;animation:_ngcontent-%COMP%_pulse 2s infinite}.create-idea-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 18px #ee82ee66;background:linear-gradient(135deg,#f091f0,#8a008a)}.create-idea-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #ee82ee4d}.create-idea-btn[_ngcontent-%COMP%]   .create-icon[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;transition:transform .3s ease}.create-idea-btn[_ngcontent-%COMP%]:hover   .create-icon[_ngcontent-%COMP%]{transform:rotate(90deg) scale(1.1)}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 4px 12px #ee82ee4d}50%{box-shadow:0 4px 20px #ee82ee80}to{box-shadow:0 4px 12px #ee82ee4d}}.no-ideas[_ngcontent-%COMP%]   .create-idea-btn[_ngcontent-%COMP%]{margin-top:20px}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-bottom:16px;margin-bottom:24px;border-bottom:2px solid #e0e0e0}.section-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#333;margin:0}.section-sort[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.sort-label[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500}.sort-options[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#fff;border:1px solid #ddd;border-radius:6px;padding:4px}.sort-option[_ngcontent-%COMP%]{padding:6px 12px;border-radius:4px;border:none;cursor:pointer;font-size:14px;color:#666;background:none;transition:.2s;font-weight:500}.sort-option.active[_ngcontent-%COMP%]{background:#f0f7ff;color:#1a73e8}.sort-option[_ngcontent-%COMP%]:hover:not(.active){background:#f5f5f5}.sort-separator[_ngcontent-%COMP%]{color:#ddd;font-size:14px;margin:0 2px}.ideas-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0;margin-bottom:30px}.idea-card[_ngcontent-%COMP%]{position:relative;padding:15px;border:1px solid #ccc;border-radius:8px;background:#fff}.promoted-badge-top-right[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background-color:violet;color:#fff;font-weight:700;font-size:12px;padding:3px 8px;border-radius:12px;box-shadow:0 0 6px #ee82ee80}.idea-card[_ngcontent-%COMP%]:hover{background:#fafafa;border-color:#1a73e8}.idea-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.vote-toggle-btn[_ngcontent-%COMP%], .details-vote-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border-radius:20px;border:1px solid #e0e0e0;background:#fff;color:#666;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.vote-toggle-btn[_ngcontent-%COMP%]:hover:not(:disabled), .details-vote-btn[_ngcontent-%COMP%]:hover:not(:disabled){border-color:#4caf50;background:#f8f8f8}.vote-toggle-btn[_ngcontent-%COMP%]:disabled, .details-vote-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.vote-toggle-btn[_ngcontent-%COMP%]   .vote-icon[_ngcontent-%COMP%], .details-vote-btn[_ngcontent-%COMP%]   .vote-icon[_ngcontent-%COMP%]{font-size:16px;transition:all .2s ease}.vote-toggle-btn[_ngcontent-%COMP%]   .vote-count[_ngcontent-%COMP%], .details-vote-btn[_ngcontent-%COMP%]   .vote-count[_ngcontent-%COMP%]{font-weight:600;min-width:0}.vote-toggle-btn[_ngcontent-%COMP%]   .vote-count[_ngcontent-%COMP%]:empty, .details-vote-btn[_ngcontent-%COMP%]   .vote-count[_ngcontent-%COMP%]:empty{display:none}.vote-toggle-btn.voted[_ngcontent-%COMP%], .voted.details-vote-btn[_ngcontent-%COMP%]{background:#4caf50;border-color:#4caf50;color:#fff}.vote-toggle-btn.voted[_ngcontent-%COMP%]   .vote-icon[_ngcontent-%COMP%], .voted.details-vote-btn[_ngcontent-%COMP%]   .vote-icon[_ngcontent-%COMP%]{transform:translateY(-1px)}.vote-toggle-btn.voted[_ngcontent-%COMP%]:hover:not(:disabled), .voted.details-vote-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#45a049;border-color:#45a049}.vote-toggle-btn.voted[_ngcontent-%COMP%]:not(:has(.vote-count:not(:empty))), .voted.details-vote-btn[_ngcontent-%COMP%]:not(:has(.vote-count:not(:empty))){padding:6px 12px}.details-vote-btn[_ngcontent-%COMP%]{padding:8px 16px;font-size:15px;display:flex}.idea-title[_ngcontent-%COMP%]{flex:1;margin:0}.idea-date[_ngcontent-%COMP%]{margin-left:auto;font-size:.9rem;color:#666}.idea-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#333;margin:0;flex:1}.idea-card-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex-shrink:0}.upvote-count[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500}.upvote-icon[_ngcontent-%COMP%]{font-size:16px;color:#666;margin-right:4px}.idea-date[_ngcontent-%COMP%]{font-size:14px;color:#999;min-width:80px;text-align:right}.idea-description[_ngcontent-%COMP%]{color:#666;line-height:1.6;margin:0;padding-left:4px}.read-more[_ngcontent-%COMP%]{color:#1a73e8;cursor:pointer;font-weight:500;margin-left:8px;text-decoration:none;font-size:14px}.read-more[_ngcontent-%COMP%]:hover{text-decoration:underline}.card-divider[_ngcontent-%COMP%]{padding:0}.divider-line[_ngcontent-%COMP%]{height:1px;background-color:#e0e0e0;margin:0}.leave-group-section[_ngcontent-%COMP%]{text-align:center;padding:20px 0;border-top:2px solid #e0e0e0;margin-top:20px}.leave-group-btn[_ngcontent-%COMP%]{background:none;border:1px solid #ff4d4f;color:#ff4d4f;padding:10px 30px;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.leave-group-btn[_ngcontent-%COMP%]:hover{background-color:#fff2f0}.sidebar-idea-header[_ngcontent-%COMP%]{margin-bottom:24px;padding-bottom:20px;border-bottom:1px solid #eee}.sidebar-idea-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#333;margin:0 0 16px}.sidebar-vote-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.sidebar-date[_ngcontent-%COMP%]{font-size:14px;color:#666}.sidebar-section[_ngcontent-%COMP%]{margin-bottom:24px}.sidebar-section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin:0 0 12px}.sidebar-idea-description[_ngcontent-%COMP%]{color:#666;line-height:1.6;font-size:15px;margin:0}.author-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.author-avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#1a73e8;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:18px}.author-details[_ngcontent-%COMP%]{flex:1}.author-name[_ngcontent-%COMP%]{font-weight:600;color:#333;font-size:16px}.author-role[_ngcontent-%COMP%]{color:#666;font-size:14px}.sidebar-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding-top:20px;border-top:1px solid #e0e0e0}.sidebar-action-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:12px;border-radius:8px;border:2px solid #e0e0e0;background:#fff;font-weight:600;cursor:pointer;transition:all .2s;font-size:15px}.sidebar-action-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.sidebar-action-btn.primary[_ngcontent-%COMP%]{background:#1a73e8;color:#fff;border-color:#1a73e8}.sidebar-action-btn.primary[_ngcontent-%COMP%]:hover{background:#0d62d9}.sidebar-action-btn.delete[_ngcontent-%COMP%]{color:#ff4d4f;border-color:#ff4d4f}.sidebar-action-btn.delete[_ngcontent-%COMP%]:hover{background:#fff2f0}@media (max-width: 1024px){.ideas-container[_ngcontent-%COMP%]{padding:15px}.idea-sidebar[_ngcontent-%COMP%]{width:100%;right:-100%}.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:15px}.header-actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.members-section[_ngcontent-%COMP%]{min-width:120px}}@media (max-width: 768px){.idea-card-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.idea-card-meta[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.idea-description[_ngcontent-%COMP%]{padding-left:0}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.section-sort[_ngcontent-%COMP%]{width:100%}}"]})};export{_e as IdeasComponent};
